---
const locale = Astro.currentLocale;
let certifications;
if (locale === 'es') {
  certifications = (await import('../data/certifications-es.js')).certifications;
} else {
  certifications = (await import('../data/certifications.js')).certifications;
}
---

<section id="certifications" class="py-20 sm:py-32 bg-gray-900/50 animate-on-scroll">
  <div class="container mx-auto px-8">
    <h2 class="text-4xl font-bold font-heading text-center animate-on-scroll">{locale === 'es' ? 'Certificaciones' : 'Certifications'}</h2>

    <!-- Store certifications data for modal access -->
    <div id="certifications-data" style="display: none;">
      {JSON.stringify(certifications)}
    </div>

    <!-- Certification Word Cloud -->
    <div class="certification-word-cloud animate-on-scroll">
      {[
        // Main certifications - should be largest
        {word: 'AWS', size: 'large', row: 1, col: 1},
        {word: 'GCP', size: 'large', row: 1, col: 2},
        {word: 'Azure', size: 'large', row: 1, col: 3},
        {word: 'Terraform', size: 'large', row: 2, col: 1},
        {word: 'Airflow', size: 'large', row: 2, col: 3},
        {word: 'DevOps', size: 'large', row: 3, col: 2},
        {word: 'Architect', size: 'large', row: 3, col: 4},
        {word: 'Engineer', size: 'large', row: 4, col: 3},

        // Important supporting words - medium size
        {word: 'Cloud', size: 'medium', row: 1, col: 4},
        {word: 'Data', size: 'medium', row: 2, col: 2},
        {word: 'Security', size: 'medium', row: 2, col: 4},
        {word: 'Certified', size: 'medium', row: 3, col: 1},
        {word: 'Professional', size: 'medium', row: 3, col: 3},
        {word: 'Infrastructure', size: 'medium', row: 4, col: 2},
        {word: 'Automation', size: 'medium', row: 4, col: 4},

        // Supporting concepts - smaller
        {word: 'CI/CD', size: 'small', row: 1, col: 5},
        {word: 'Pipeline', size: 'small', row: 2, col: 5},
        {word: 'Serverless', size: 'small', row: 3, col: 5},
        {word: 'Containers', size: 'small', row: 4, col: 1},
        {word: 'Kubernetes', size: 'small', row: 4, col: 5},
        {word: 'Docker', size: 'small', row: 5, col: 1},
        {word: 'Microservices', size: 'small', row: 5, col: 2},
        {word: 'API', size: 'small', row: 5, col: 3},
        {word: 'Database', size: 'small', row: 5, col: 4},
        {word: 'BigQuery', size: 'small', row: 5, col: 5},
        {word: 'Compute', size: 'small', row: 6, col: 1},
        {word: 'Storage', size: 'small', row: 6, col: 2},
        {word: 'Networking', size: 'small', row: 6, col: 3},
        {word: 'Monitoring', size: 'small', row: 6, col: 4},
        {word: 'Logging', size: 'small', row: 6, col: 5},
        {word: 'Scalability', size: 'small', row: 7, col: 2},
        {word: 'Reliability', size: 'small', row: 7, col: 3},
        {word: 'Performance', size: 'small', row: 7, col: 4},
        {word: 'Optimization', size: 'small', row: 8, col: 2},
        {word: 'Compliance', size: 'small', row: 8, col: 3},
        {word: 'Governance', size: 'small', row: 8, col: 4},
        {word: 'Associate', size: 'small', row: 8, col: 5}
      ].map((item, index) => {
        const sizes = {large: 24, medium: 18, small: 14};
        const baseSize = sizes[item.size] || 16;
        const sizeVariation = baseSize + Math.random() * 2;

        // Calculate position based on tighter grid with minimal randomness
        const colWidth = 100 / 5; // 5 columns for more compact layout
        const rowHeight = 100 / 6; // 6 rows for more compact layout
        const leftPos = (item.col - 1) * colWidth + colWidth / 2 + (Math.random() * 0.1 - 0.05) * 100;
        const topPos = (item.row - 1) * rowHeight + rowHeight / 2 + (Math.random() * 0.1 - 0.05) * 100;

        return (
          <span
            class={`word-cloud-item ${item.size}`}
            style={`
              font-size: ${sizeVariation}px;
              left: ${leftPos}%;
              top: ${topPos}%;
              animation-delay: ${Math.random() * 2}s;
              animation-duration: ${8 + Math.random() * 3}s;
              transform: rotate(${Math.random() * 3 - 1.5}deg);
            `}
          >
            {item.word}
          </span>
        );
      })}
    </div>

    <!-- Enhanced Carousel Container -->
    <div class="mt-12 certification-carousel-container relative max-w-5xl mx-auto">
      <div class="certification-carousel overflow-hidden">
        <div class="flex transition-transform duration-500 ease-in-out">
          {certifications.map((cert, index) => (
            <div class={`certification-slide flex-shrink-0 w-full sm:w-1/2 md:w-1/3 lg:w-1/4 p-2 ${index === 0 ? 'active' : ''}`}>
              <a href={cert.url} target="_blank" rel="noopener noreferrer" class="block h-full">
                <div class="certification-card h-full bg-gray-800 rounded-lg p-4 transition-all duration-300 hover:bg-gray-700">
                  <div class="flex justify-center mb-3">
                    <img src={cert.image} alt={cert.title} class="h-32 w-32 object-contain">
                  </div>
                  <h3 class="text-center text-xs font-medium text-gray-300 transition-colors group-hover:text-primary px-2">{cert.title}</h3>
                </div>
              </a>
            </div>
          ))}
        </div>
      </div>

      <!-- Navigation Buttons -->
      <button class="certification-nav prev">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <button class="certification-nav next">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>

      <!-- Progress Dots -->
      <div class="certification-progress"></div>
    </div>
  </div>

  <!-- Modal for Certification Details -->
  <div id="certification-modal" class="certification-modal">
    <div class="certification-modal-content">
      <h3 class="certification-modal-title text-2xl font-bold mb-4 text-white"></h3>
      <div class="flex justify-center mb-4">
        <img src="" alt="Certification" class="certification-modal-image h-48 w-48 object-contain">
      </div>
      <p class="certification-modal-description text-gray-300 mb-6 text-center"></p>
      <div class="flex justify-center gap-4">
        <button class="certification-modal-close bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-500 transition-colors">
          Close
        </button>
        <a href="" target="_blank" rel="noopener noreferrer" class="certification-modal-url inline-block bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark transition-colors">
          View Certification
        </a>
      </div>
    </div>
  </div>
</section>

